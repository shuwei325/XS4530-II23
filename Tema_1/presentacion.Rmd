---
title: "Tema 2.3. Series de tiempo para pronóstico"
subtitle: "Curso: Decisiones Estadísticas y Administrativas"
author: "Prof. Shu Wei Chou Chen"
institute: "Escuela de Estadística, UCR"
date: ""
output:
  xaringan::moon_reader:
    css: [default,  metropolis, metropolis-fonts, ninjutsu,"text_color.css"]
  html_document: default
  pdf_document: default
fontsize: 12pt
---
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo = TRUE,fig.dim=c(4.8, 4.5), fig.retina=2, out.width="100%")
```


```{r, include=FALSE}
library(ggplot2)
library(forecast)
library(fpp2)
library(astsa)
library(quantmod)
library(xts)
```

# Subtemas:

1. **Series de tiempo y pronóstico**
2. Descomposición de series temporales
3. Técnicas de suavizamiento exponencial
4. Regresión aplicada a series cronológicas


---
# Contenido

1. Consideraciones generales
2. Series continuas y discretas
3. Objetivos
4. Componentes de las series temporales
5. Ejemplos
6. Análisis exploratorio de series de tiempo


---
# Consideraciones generales 

Una **serie temporal** (**serie cronológica** o **serie de tiempo**) es una colección de datos recolectados en el tiempo.

Ejemplos:
  - **Economía**:
      - exportaciones, ventas, tipo de cambio, bolsa de valores.
  - **Medicina**:
      - número de casos de una enfermedad, electrocardiograma de un paciente.
  - **Meteorología**: 
      - precipitación, temperatura
      - contaminación de una cierta partícula.
      - promedio anual de manchas solares
  - **Demografía**:
      - mortalidad, natalidad.
      
---
# Series temporales continuas y discretas

- Una series temporal **continua**: si las observaciones de la serie se registran para todo tiempo $t$ en un intervalo de tiempo.
  - registro continuo de la temperatura.
  - registro continuo de marea en Puntarenas.

- Una series temporal **discreta**: si las observaciones de la serie se registran  sólo en momentos particulares. Puede ser equiespaciadas o no.
  - precipitación anual en San José.
  - número diario de casos nuevos de COVID19.


---
# Series temporales continuas y discretas

- El muestreo de una serie continua realizado en intervalos de tiempo iguales, $\Delta t$, en un intervalo de tiempo $[0,T]$ produce una serie discreta equiespaciada de $N=\frac{T}{\Delta t}$ puntos.
  - temperatura medida en cada hora.

- Otro caso es cuando se toma el valor de la serie acumulando (o agregando) valores en intervalos de tiempos iguales.
  - temperatura promedio de cada hora en una estación atmosférica.
  - precipitación mensual en un área específica.

- Ejemplos de la diapositiva 4:
  - ¿Cuáles son discretas y cuáles son continuas?

- En este curso, enfocamos en series discretas equiespaciadas.

---
# Ejemplos:

.pull-left[
```{r echo=FALSE}
plot(gtemp, type="o", ylab="Global Temperature Deviations")
```
Figura 1. Desviación de temperatura global promedio (1880-2015) en grados centígrados (periodo base 1951-1980)
]

.pull-right[
```{r echo=FALSE}
plot(speech)  
```
Figura 2. Grabación de "aaahhh" muestreada de 10.000 puntos por segundo con n = 1020.
]

---
# Objetivos del análisis de series temporales
  
  - **Predicción:** pronosticar valores en el futuro. Puede ser de corto plazo (series de ventas y de producción) o largo plazo (series de población, series relacionadas al calendamiento global, etc.).
  
  - **Descripción:** describir por medio de gráficos o modelos el fenómeno. Verificar de existencia de tendencias, ciclos, estacionalidad. Encontrar periodicidad de los datos.
  
  - **Simulación:** generar posibles escenarios con condiciones estrictas.

  - **Control de procesos:** mantener en control una cierta variable en el tiempo.

---
# Componentes de las series temporales

* Existe varios componentes en el comportamiento de series temporales:

  1. **Tendencia:** comportamiento creciente o decreciente en largo plazo. Ej: crecimiento de población, ingresos por ventas.
  2. **Estacionalidad:** patrón o variaciones afectadas por repetición de una frecuencia dada (ej. semana, mes y año.). Consecuencia de cambios climáticos, comportamiento de la gente en el tiempo. Ej: venta de productos que dependen de la temporada, temperatura, pasajes de avión. 
  3. **Ciclo:** cuando los datos muestran subidas y bajadas de largo plazo, generalmente con frecuencia desconocida. Ej: ciclo económico, período de prosperidad alternando con período de recesión.
  4. **Movimiento irregular o error:** variaciones en la serie que no siguen ningún patrón regular. Es el residuo que queda en una serie después de eliminar los componentes anteriores (tendencia-ciclo y estacionalidad).

---
# Ejemplo: pasajeros

La base de datos "AirPassenger" en R proporciona total de pasajeros mensuales de una aerolínea estadounidense de 1949 a 1960. 

```{r echo=FALSE, out.width = "40%", fig.align="center"}
data(AirPassengers)
autoplot(AirPassengers)
```

---
# Descomposición de series temporales
## Ejemplo: pasajeros

.pull-left[
```{r echo=FALSE, out.width = "90%"}
ggseasonplot(AirPassengers, year.labels=FALSE, continuous=TRUE)
```
]
.pull-right[
```{r echo=FALSE, out.width = "90%"}
decomposeAP <- decompose(AirPassengers,"multiplicative")
autoplot(decomposeAP)
```
]


---
# Ejemplo: llegadas internacionales
  
La base de datos `fpp2::arrivals` tiene los datos de llegadas internacionales (en miles) a Australia de Japón, Nueva Zelanda, Reino Unido y Estados Unidos por cuatrimestre.

.pull-left[
```{r echo=FALSE}
autoplot(arrivals)
```
]

.pull-right[
```{r echo=FALSE}
autoplot(arrivals, facets = TRUE)
```
]

---
# Ejemplo: llegadas internacionales
  
```{r echo=FALSE, message=FALSE,  out.width = "60%", fig.align="center"}
autoplot(arrivals, facets = TRUE) +
  geom_smooth() +
  labs("International arrivals to Australia",
       y = "Arrivals (in thousands)",
       x = NULL)
```

---
# Ejemplo: 

Promedio diario industrial Dow Jone (20 de abril, 2006 a 20 de abril, 2016)

```{r echo=FALSE,warning=FALSE, message=FALSE, fig.align="center", out.width = "40%"}
getSymbols("^DJI",from = "2016/12/31",
           to = "2018/12/31",
           periodicity = "daily")
y <- DJI$DJI.Close
plot(y)
```


---
# Segunda parte
## Análisis exploratorio de series de tiempo. 

